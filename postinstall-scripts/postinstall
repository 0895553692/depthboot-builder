#!/usr/bin/env python3

import os
from os import system as bash
from subprocess import check_output as bash_return
import sys

if __name__ == "__main__":
    # Elevate script to root
    if not os.geteuid() == 0:
        sudo_args = ['sudo', sys.executable] + sys.argv + [os.environ]
        os.execlpe('sudo', *sudo_args)
    # read root partition mount
    root_part = bash_return("mount | grep ' / ' | cut -d' ' -f 1", shell=True, text=True).strip()
    root_part = root_part[:len(root_part) - 1]  # get device "name"
    bash(f"growpart {root_part} 2")
    # delete systemd service
    bash("systemctl disable postinstall.service")
    os.remove("/etc/systemd/system/postinstall.service")
